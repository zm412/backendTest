
<!DOCTYPE html>
<html>
<head>
    <title>Добавление пользователя</title>
    <meta charset="utf-8" />
<style>
.field{
  width:180px;
}


table{
display: none;
width: 100%;
border-collapse: collapse;
top: 40px;
left: 40px;
}
td, th{
text-align: center;
border: 1px solid black;
padding: 10px;
}

form{
  padding: 20px;
}

.none{
pointer-events: none;

}

</style>
</head>
<body>
  <div class='form'>
    <h1>Get info</h1>
       <form id="lessons" action="" method="POST">

        <label>Title</label><br>
        <input id='title' class="field"/><br><br>

        <label>teacher id</label><br>
        <input id='teacherIds' name="teacherIds" class="field"  /><br><br>

        <label>0</label><br>
        <input id='day0' name="daysForLesson" data-info='0' type="checkbox" class="field" /><br><br>
        
        <label>1</label><br>
        <input id='day1' name="daysForLesson"  data-info='1' type="checkbox" class="field" /><br><br>

        <label>2</label><br>
        <input id='day2' name="daysForLesson"  data-info='2' type="checkbox" class="field" /><br><br>

        <label>3</label><br>
        <input id='day3' name="daysForLesson"  data-info='3' type="checkbox" class="field" /><br><br>

        <label>4</label><br>
        <input id='day4' name="daysForLesson"  data-info='4' type="checkbox" class="field" /><br><br>

        <label>5</label><br>
        <input id='day5' name="daysForLesson"  data-info='5' type="checkbox" class="field" /><br><br>

        <label>6</label><br>
        <input id='day6' name="daysForLesson"  data-info='6' type="checkbox" class="field" /><br><br>


        <label>FirstDate</label><br>
        <input id='firstDate'  class="field"  /><br><br>

        <label>LessonsCount</label><br>
        <input name="choosingFinishTime" id='lessonsCount' type="radio" class="field" /><br><br>
        <label>LastDay</label><br>
        <input name="choosingFinishTime" id='lastDay' type="radio" class="field" /><br><br>

        <input type="submit" value="Отправить" />
     </form>
  </div>
     <br><br>
     <div >
    
     <a href="/">Вернуться к фильтру</a>
       </p>
     </div>

  <script>

    let titleElem = document.querySelector("#title");
    let formLessons = document.querySelector("#lessons");
    let teacherIdsElem = document.querySelector("#teacherIds");
    let day0 = document.querySelector("#day0");
    let day1 = document.querySelector("#day1");
    let day2 = document.querySelector("#day2");
    let day3 = document.querySelector("#day3");
    let day4 = document.querySelector("#day4");
    let day5 = document.querySelector("#day5");
    let day6 = document.querySelector("#day6");
    let lessonsCount = document.querySelector("#lessonsCount");
    let page = document.querySelector("#page");
let daysArr = [day0, day1, day2, day3, day4, day5, day6].reduce(list, item =>{
  if(item.value == 'on') return list.push(item.datasetInfo)
}, []);
    
    

    formLessons.onsubmit = async (e) => {
      let bodyJSON = JSON.stringify({title: titleElem.value, teacherIds: teacherIdsElem.value, days: daysArr });
      e.preventDefault();
      console.log(bodyJSON)

    fetch('/lessons', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: bodyJSON })
      .then(response => response.text())
      .then(result => {
          console.log(result);
        let obj = JSON.parse(result)
          getTbl(tbl,obj)
          formBlock.style.cssText +=   'display: none';
          tbl.style.cssText += 'display: inline'
          console.log(result)
           
        })
      .catch(err => {
        console.log('err', err);
      })

  };

function getTbl(elem, arr){
	let k = 0;
		for(let i = 0; i < arr.length ; i++){
			let tr = createEl('tr', elem);
      for(let key in arr[i]){
        let td = createEl('td', tr);
        if(!Array.isArray(arr[i][key])){
          td.innerHTML = arr[i][key]
        }else{
          getTbl(td, arr[i][key])
        }
      }
			}
}

function createEl(tag, par ){
	let el = document.createElement(tag);
		par.appendChild(el);
		return el;
}

  </script>
</body>

<html>

